/*!
 *
 * # BiB/i Extension: Share
 *
 * - Copyright (c) Satoru MATSUSHIMA - http://bibi.epub.link or https://github.com/satorumurmur/bibi
 * - Licensed under the MIT license. - http://www.opensource.org/licenses/mit-license.php
 */
Bibi.x({name:"Share",description:"Share webpages and embedded books via SNS.",author:"Satoru MATSUSHIMA (@satorumurmur)",version:Bibi.version,build:Bibi.build})(function(){var e=I.createButtonGroup({Area:I.Menu.R}),t=e.addButton({Type:"toggle",Labels:{"default":{"default":"Share",ja:"シェア"},active:{"default":"Close Share-Menu",ja:"シェアメニューを閉じる"}},Help:!0,Icon:'<span class="bibi-icon bibi-icon-share"></span>'}),n=I.createSubPanel({Opener:t,id:"bibi-subpanel_share",open:function(){sML.each(this.querySelectorAll(".parent-title"),function(){this.innerHTML=U["parent-title"]}),sML.each(this.querySelectorAll(".book-title"),function(){this.innerHTML=document.title})},getShareURI:function(e,t){var n="",i="";switch(e){case"P":n=U["parent-title"],i=U["parent-uri"];break;case"B":n=document.title,i=O.ReadiedURL}switch(t){case"T":return"https://twitter.com/intent/tweet?url="+encodeURIComponent(i)+"&text="+encodeURIComponent(n)+"&hashtags=bibipub";case"F":return"https://www.facebook.com/sharer.php?u="+encodeURIComponent(i);case"G":return"https://plus.google.com/share?url="+encodeURIComponent(i)}return""}});U["parent-uri"]&&n.addSection({Labels:{"default":{"default":"Share the Embedded Webpage",ja:"埋め込まれたページをシェア"}},ButtonGroup:{Tiled:!0,Buttons:[{Type:"link",Labels:{"default":{"default":"Twitter"}},Icon:'<span class="bibi-icon bibi-icon-Twitter"></span>',href:n.getShareURI("P","T"),execute:function(){this.href=n.getShareURI("P","T")},on:{click:function(){return!1}}},{Type:"link",Labels:{"default":{"default":"Facebook"}},Icon:'<span class="bibi-icon bibi-icon-Facebook"></span>',href:n.getShareURI("P","F"),execute:function(){this.href=n.getShareURI("P","F")},on:{click:function(){return!1}}},{Type:"link",Labels:{"default":{"default":"Google+"}},Icon:'<span class="bibi-icon bibi-icon-GooglePlus"></span>',href:n.getShareURI("P","G"),execute:function(){this.href=n.getShareURI("P","G")},on:{click:function(){return!1}}}]}}).querySelector(".bibi-h-label").appendChild(sML.create("small",{className:"parent-title"})),n.addSection({Labels:{"default":{"default":"Share This Book",ja:"この本をシェア"}},ButtonGroup:{Tiled:!0,Buttons:[{Type:"link",Labels:{"default":{"default":"Twitter"}},Icon:'<span class="bibi-icon bibi-icon-Twitter"></span>',href:n.getShareURI("B","T"),execute:function(){this.href=n.getShareURI("B","T")},on:{click:function(){return!1}}},{Type:"link",Labels:{"default":{"default":"Facebook"}},Icon:'<span class="bibi-icon bibi-icon-Facebook"></span>',href:n.getShareURI("B","F"),execute:function(){this.href=n.getShareURI("B","F")},on:{click:function(){return!1}}},{Type:"link",Labels:{"default":{"default":"Google+"}},Icon:'<span class="bibi-icon bibi-icon-GooglePlus"></span>',href:n.getShareURI("B","G"),execute:function(){this.href=n.getShareURI("B","G")},on:{click:function(){return!1}}}]}}).querySelector(".bibi-h-label").appendChild(sML.create("small",{className:"book-title"})),O.Head.appendChild(sML.create("script",{async:"async",src:"//platform.twitter.com/widgets.js"}))});